<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Name/Value Pair Manager</title>
  <style>
    :root {
      --bg: #e7eef7;
      --panel: #fff;
      --ink: #1f2937;
      --muted: #6b7280;
      --accent: #2563eb;
      --danger: #dc2626;
      --radius: 12px;
      --gap: 14px;
    }

    * { box-sizing: border-box; }
    html, body { height: 100%; }
    body {
      margin: 0;
      font-family: system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial, sans-serif;
      color: var(--ink);
      background: radial-gradient(1200px 800px at 20% -10%, #cfe0ff 0%, var(--bg) 50%, #cfe0ff 120%);
      display: grid;
      place-items: center;
      padding: 24px;
    }

    .card {
      width: 100%;
      max-width: 860px;
      background: var(--panel);
      border-radius: var(--radius);
      box-shadow: 0 10px 30px rgba(31, 41, 55, .12);
      padding: 24px;
    }

    h1 {
      margin: 0 0 18px;
      font-size: clamp(20px, 2vw, 28px);
    }

    .grid {
      display: grid;
      grid-template-columns: 1fr auto;
      grid-template-rows: auto auto 1fr;
      gap: var(--gap);
    }

    /* Row 1: input + Add */
    .pair-input { grid-column: 1 / 2; display: flex; gap: 10px; }
    .pair-input input {
      flex: 1;
      padding: 10px 12px;
      border: 1px solid #d1d5db;
      border-radius: 8px;
      font-size: 16px;
    }
    .pair-input button {
      padding: 10px 14px;
      border: 0;
      border-radius: 8px;
      background: var(--accent);
      color: white;
      font-weight: 600;
      cursor: pointer;
    }
    .pair-input button:disabled {
      opacity: .55; cursor: not-allowed;
    }

    /* Row 2: label + sort/delete column */
    .list-label { color: var(--muted); font-size: 14px; }

    .actions {
      grid-row: 2 / 4;
      grid-column: 2 / 3;
      display: grid;
      gap: 10px;
      align-content: start;
      width: 160px;
    }

    .actions button {
      padding: 10px 12px;
      border: 1px solid #d1d5db;
      background: #f9fafb;
      border-radius: 8px;
      font-weight: 600;
      cursor: pointer;
    }
    .actions button:hover { background: #eef2ff; border-color: #c7d2fe; }
    .actions .danger { color: white; background: var(--danger); border-color: var(--danger); }
    .actions .danger:hover { filter: brightness(1.05); }

    /* Row 3: listbox */
    .listbox {
      grid-column: 1 / 2;
      width: 100%;
      height: 360px;
      border: 1px solid #d1d5db;
      border-radius: 8px;
      padding: 8px;
      font-size: 15px;
    }

    .help {
      margin-top: 10px;
      color: var(--muted);
      font-size: 13px;
    }

    .error {
      margin-top: 8px;
      color: var(--danger);
      font-weight: 600;
      font-size: 14px;
      min-height: 1.2em;
    }

    /* Responsive: stack controls on small screens */
    @media (max-width: 720px) {
      .grid {
        grid-template-columns: 1fr;
        grid-template-rows: auto auto auto auto;
      }
      .actions {
        grid-column: 1 / -1;
        grid-row: auto;
        width: 100%;
        grid-template-columns: repeat(3, 1fr);
      }
      .listbox { height: 300px; }
    }
  </style>
</head>
<body>
<main class="card" role="application" aria-label="Name/Value Pair Manager">
  <h1>Test</h1>

  <div class="grid">
    <!-- Row 1 -->
    <div class="pair-input">
      <label for="pair" class="visually-hidden">Name/Value Pair</label>
      <input id="pair" placeholder="Name=Value" autocomplete="off" inputmode="text" />
      <button id="addBtn" type="button" disabled>Add</button>
    </div>

    <!-- Row 2 -->
    <div class="list-label">Name/Value Pair List</div>
    <div class="actions">
      <button id="sortName" type="button">Sort by Name</button>
      <button id="sortValue" type="button">Sort by Value</button>
      <button id="deleteBtn" class="danger" type="button">Delete</button>
    </div>

    <!-- Row 3 -->
    <select id="list" class="listbox" size="12" multiple aria-label="Name/Value pairs"></select>
  </div>

  <div id="error" class="error" role="status" aria-live="polite"></div>
  <p class="help">Format: <code>Name=Value</code> (letters & numbers only). Spaces around “=” are allowed.</p>
</main>

<script>
  // --- State ---------------------------------------------------------------
  /** @type {{name:string,value:string}[]} */
  let pairs = [];

  // --- Elements -----------------------------------------------------------
  const input   = document.getElementById('pair');
  const addBtn  = document.getElementById('addBtn');
  const listEl  = document.getElementById('list');
  const sortN   = document.getElementById('sortName');
  const sortV   = document.getElementById('sortValue');
  const delBtn  = document.getElementById('deleteBtn');
  const errorEl = document.getElementById('error');

  // --- Utils --------------------------------------------------------------
  const parsePair = (raw) => {
    // Trim overall, then capture "name = value" allowing spaces around '='
    const m = String(raw).trim().match(/^([A-Za-z0-9]+)\s*=\s*([A-Za-z0-9]+)$/);
    if (!m) return null;
    return { name: m[1], value: m[2] };
  };

  const render = () => {
    listEl.innerHTML = '';
    for (const {name, value} of pairs) {
      const option = document.createElement('option');
      option.value = `${name}=${value}`;
      option.textContent = `${name}=${value}`;
      listEl.appendChild(option);
    }
    // Update buttons availability
    delBtn.disabled = listEl.selectedOptions.length === 0;
    sortN.disabled  = pairs.length < 2;
    sortV.disabled  = pairs.length < 2;
  };

  const showError = (msg = '') => { errorEl.textContent = msg; };
  const toggleAdd = () => { addBtn.disabled = !parsePair(input.value); };

  // --- Event handlers -----------------------------------------------------
  input.addEventListener('input', () => {
    showError('');
    toggleAdd();
  });

  input.addEventListener('keydown', (e) => {
    if (e.key === 'Enter' && !addBtn.disabled) {
      e.preventDefault();
      addBtn.click();
    }
  });

  addBtn.addEventListener('click', () => {
    const parsed = parsePair(input.value);
    if (!parsed) {
      showError('Invalid format. Use Name=Value with only letters/numbers.');
      return;
    }
    pairs.push(parsed);
    input.value = '';
    toggleAdd();
    showError('');
    render();
    input.focus();
  });

  sortN.addEventListener('click', () => {
    pairs.sort((a, b) => a.name.localeCompare(b.name, undefined, {numeric: true}));
    render();
  });

  sortV.addEventListener('click', () => {
    pairs.sort((a, b) => a.value.localeCompare(b.value, undefined, {numeric: true}));
    render();
  });

  listEl.addEventListener('change', () => {
    delBtn.disabled = listEl.selectedOptions.length === 0;
  });

  delBtn.addEventListener('click', () => {
    if (listEl.selectedOptions.length === 0) return;
    const toDelete = new Set(Array.from(listEl.selectedOptions).map(o => o.value));
    pairs = pairs.filter(p => !toDelete.has(`${p.name}=${p.value}`));
    render();
  });

  // Initial
  render();
  toggleAdd();

  // a11y: hide-only label helper
  (function ensureHiddenLabelStyle(){
    const css = `.visually-hidden{position:absolute!important;clip:rect(1px,1px,1px,1px);padding:0;border:0;height:1px;width:1px;overflow:hidden;white-space:nowrap}`;
    const style = document.createElement('style');
    style.textContent = css;
    document.head.appendChild(style);
  })();
</script>
</body>
</html>
